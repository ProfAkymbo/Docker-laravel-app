# Laravel setup using Docker
### Task
1. write a dockerfile for laravel app.
2. write a docker compose file for the services involved in the laravel app,
- mount a volume to write a real time log entry and name the directory.
-  Also mount a volume to write mysql data and name the directory.

Dockerfile includes instructions that Docker can use to build custom Docker images. It can also install the software required and configure the necessary settings for your application. They specify the environment inside a container that will host your application code. You may push the images you create to docker hub for sharing or place them on other private registries.
We will create a Dockerfile that will specify the instructions to build the Laravel application image.

### Dockerfile

```
# Use an official PHP image as the base image
FROM php:7.4-apache

# Set the working directory to /app
WORKDIR /app

# Copy the entire project to the container
COPY . /app

# Install required PHP extensions
RUN apt-get update && apt-get install -y \
    libzip-dev \
    unzip \
  && docker-php-ext-install \
    zip \
    pdo_mysql

# Install composer
RUN curl -sS https://getcomposer.org/installer | php \
  && mv composer.phar /usr/local/bin/composer

# Install dependencies
RUN composer install --no-dev --optimize-autoloader

# Copy the Apache configuration file to the container
COPY .docker/vhost.conf /etc/apache2/sites-available/000-default.conf

# Enable mod_rewrite for Apache
RUN a2enmod rewrite

# Expose port 80
EXPOSE 80

# Start Apache
CMD ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]
```

The Dockerfile above uses PHP 7.4 and Apache as the base image, copies the entire Laravel project to the container, installs required PHP extensions and dependencies, and starts Apache. You can customize the Dockerfile based on your specific requirements.

### docker-compose.yml

```
version: '3'
services:
  web:
    build: .
    ports:
      - 80:80
    volumes:
      - ./logs:/app/logs
  db:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: laravel
      MYSQL_USER: laravel
      MYSQL_PASSWORD: password
    volumes:
      - db-data:/var/lib/mysql
volumes:
  db-data:
```

In the docker-compose.yml above, the file includes two services: (web and db). The web service uses the Dockerfile in the current directory to build the image, and maps port 80 on the host to port 80 on the container. The db service uses the MySQL 8.0 image and sets up the environment variables for the root password, database name, and user credentials. The data for the MySQL database is stored in a named volume called db-data.
You can customize the docker-compose.yml file based on your specific requirements. For example, you can add additional services for Redis, Memcached, or other dependencies.

The web service mounts a volume that maps the ./logs directory on the host to the /app/logs directory in the container. This will allow the logs generated by the Laravel app to be written to the ./logs directory on the host in real-time, so you can access the logs outside of the container.
Note that the ./logs directory must exist on the host, otherwise the mount will fail. You can create the ./logs directory by running mkdir logs in the terminal.  
 
while the db service mounts a volume that maps the db-data directory on the host to the /var/lib/mysql directory in the container. This will allow the data for the MySQL database to be stored in the db-data directory on the host, so it can persist even if the container is deleted or recreated.

Note that the db-data volume is declared at the bottom of the docker-compose.yml file, and can be named anything you like.
